<?php

$carouselDetails = array(
    (object)array(
        'elemClassName' => 'book-preview-square',
        'img' => (object) array(
            'elemClassName' => 'time-book-first-page',
        ),
        'artist' => (object) array(
            'name' => 'D. S. Chidgey',
            'uri' => ''
        ),
        'title' => 'Time'
    ),
    (object)array(
        'elemClassName' => 'book-preview-square',
        'artist' => (object) array(
            'name' => 'Ivor Cutler &#40;with permission of the estate of Ivor Cutler&#41;',
            'uri' => 'http://www.ivorcutler.org'
        ),
        'extract' => (object)array(
            'title' => '',
            'blurb' => '<p>"Time does not belong to me</p><p>It spreads itself like air</p><p>I move about in it, but have no place"</p><p class="bottom-margin">written by ivor cutler</p><p>Printed with permission of the Estate of Ivor Cutler</p><a class="highlight" href="http://www.ivorcutler.org" target="_blank">www.ivorcutler.org</a> <br />Time_'
        )
    ),
    (object) array(
        'elemClassName' => 'book-preview-rectangle',
        'img' => (object) array(
            'elemClassName' => 'bryn-hall',
        ),
        'artist' => (object) array(
            'name' => 'Bryn Hall',
            'uri' => 'journal/bryn-halls-five-things'
        ),
        'title' => 'Grok'
    ),
    (object) array(
        'elemClassName' => 'book-preview-square',
        'artist' => (object) array(
            'name' => 'Megan Leonie Hall',
            'uri' => 'journal/megan-leonie-halls-five-things'
        ),
        'extract' => (object) array(
            'title' => 'The Truth is, Mr Owl',
            'blurb' => "The truth is, Mr Owl, I have been very afraid living here. The truth is, little one, this isn’t the first time I've visited you. I've seen everything and I will continue to. You can feel me beside you, my feathers against your skull and ear. My voice inside your inside voice. I slip in close beside your consciousness. So smooth and stealthy you didn't notice before this moment. So now draw back the shades that obscure your own lucidity from you. I cannot be called for by your tongue or your wishing in the cold night, but I’ll push words through your pores. I am always watching those who cannot watch themselves."
        )
    ),
    (object)array(
        'elemClassName' => 'book-preview-rectangle',
        'img' => (object) array(
            'elemClassName' => 'lee-holland',
        ),
        'artist' => (object) array(
            'name' => 'Lee Holland',
            'uri' => 'leeholland'
        ),
        'title' => 'Optimistic'
    ),
    (object)array(
        'elemClassName' => 'book-preview-square',
        'artist' => (object) array(
            'name' => 'Will Conway',
            'uri' => 'journal/will-conways-five-things'
        ),
        'extract' => (object)array(
            'title' => 'I Told Her to Hold out her Hands',
            'blurb' => '<p>I told her to hold out her hands and poured the coins into them. One by one I put the coins back into the purse until only my old friend remained.</p><p class="tab-left">"What is so special about this one? It is no different."</p><p class="tab-left">"It\'s mine, that\'s all</p><p class="tab-left">"There\'s something funny about you."</p> <p>There was something funny about her too and, as I handed her back the rest of the money, I had the sudden urge to kiss her again.</p>'
        )
    ),
    (object)array(
        'elemClassName' => 'book-preview-square',
        'img' => (object) array(
            'elemClassName' => 'time-book-illustrations',
        ),
        'artist' => (object) array(
            'name' => 'D. S. Chidgey',
            'uri' => ''
        ),
        'title' => 'Illustrations'
    ),
    (object)array(
        'elemClassName' => 'book-preview-square',
        'extract' => (object)array(
            'title' => 'Illustrations',
            'blurb' => 'The stories and poems included in the book were passed to a huge variety of illustrators, artists and photographers. They interpreted the words as literally or loosely, drawing out the meaning that was conveyed to them upon reading.'
        )
    ),
    (object)array(
        'elemClassName' => 'book-preview-rectangle',
        'img' => (object) array(
            'elemClassName' => 'claud-forsbrey',
        ),
        'artist' => (object) array(
            'name' => 'Claud Forsbrey',
            'uri' => 'claudforsb'
        ),
        'title' => 'Warrior Girl'
    ),
    (object)array(
        'elemClassName' => 'book-preview-square',
        'artist' => (object) array(
            'name' => 'Stacie Withers',
            'uri' => 'journal/stacie-withers-five-things'
        ),
        'extract' => (object)array(
            'title' => 'Warm Skin',
            'blurb' => '<p>Warm skin, dark eyes, fingers, count them, ten,</p><p>to reach and touch and point, to form</p><p>a fist and fight.  I am ready, and far less fearful now than you.</p><p>I am the you that you thought you were going to be.</p>'
        )
    ),
    (object)array(
        'elemClassName' => 'book-preview-square',
        'img' => (object) array(
            'elemClassName' => 'carl-laurance',
        ),
        'artist' => (object) array(
            'name' => 'Carl Laurence',
            'uri' => 'journal/carl-laurences-five-things'
        ),
        'title' => 'Eibar'
    ),
    (object)array(
        'artist' => (object) array(
            'name' => 'Sam Rawlings',
            'uri' => 'samrawlings'
        ),
        'elemClassName' => 'book-preview-square',
        'extract' => (object)array(
            'title' => 'Only the gun remained',
            'blurb' => '"Only the gun remained. She bent over and picked it up, fingers feeling out the warmth of her father’s hand. Its weight bent her wrist and buckled her skinny arms."'
        )
    ),
    (object)array(
        'elemClassName' => 'book-preview-rectangle no-edge',
        'img' => (object) array(
            'elemClassName' => 'rima-staines',
        ),
        'artist' => (object) array(
            'name' => 'Rima Staines',
            'uri' => 'thehermitage'
        ),
        'title' => 'The Scrimstone Circus'
    ),
    (object)array(
        'elemClassName' => 'book-preview-square',
        'artist' => (object) array(
            'name' => 'Tom Hirons',
            'uri' => 'journal/tom-hirons-five-things'
        ),
        'extract' => (object)array(
            'title' => 'In the Midst of the Celebrations',
            'blurb' => 'In the midst of the celebrations, a drunken man &#40;with little in the way of name or, apparently, story&#41; shot and killed my father. They say he died happy, but I am less certain. I never saw it happen, though, for I was long-gone with a two-thirds share of his savings in my bag. They say he was buried in a fine suit. It cannot have been his own.'
        )
    ),
    (object)array(
        'elemClassName' => 'book-preview-square',
        'img' => (object) array(
            'elemClassName' => 'time-book-text',
        ),
        'artist' => (object) array(
            'name' => 'Dan Prescott',
            'uri' => 'd_j_prescott'
        ),
        'title' => 'Type Setting'
    ),
    (object)array(
        'elemClassName' => 'book-preview-square',
        'extract' => (object)array(
            'title' => 'Type Setting',
            'blurb' => 'Each section of the book has been designed and type set in a distinctive fashion to echo the epoch of the stories.'
        )
    ),
    (object)array(
        'elemClassName' => 'book-preview-rectangle',
        'img' => (object) array(
            'elemClassName' => 'andrew-walter',
        ),
        'artist' => (object) array(
            'name' => 'Andrew Walter',
            'uri' => 'journal/andrew-walters-five-things'
        ),
        'title' => 'Peter'
    ),
    (object)array(
        'elemClassName' => 'book-preview-square',
        'artist' => (object) array(
            'name' => 'Jodie Daber',
            'uri' => 'jodiedaber'
        ),
        'extract' => (object)array(
            'title' => 'The stopper stops',
            'blurb' => 'The stopper stops to let another train pass and Peter stares through the window into the scraplands that line the tracks, the bits of place that are neither here nor there, just unnamed woodlands and the backs of things.  And there amongst the peeling birch Peter sees a man, inked and shirtless in the mossy light, a chicken clutched like bagpipes under one ham-hock arm. The train peels away and Peter cranes his neck but all he catches is the flick of the man’s head and the flight of another as it arcs in a flurry of feathers and blood to land beak-down in the leaves.'
        )
    ),
    (object)array(
        'elemClassName' => 'book-preview-rectangle',
        'img' => (object) array(
            'elemClassName' => 'jeannie-paske',
        ),
        'artist' => (object) array(
            'name' => 'Jeannie Paske',
            'uri' => 'journal/jeannie-paskes-five-things'
        ),
        'title' => 'Haunted by the Perpetual Roar of Gravity'
    ),
    (object)array(
        'elemClassName' => 'book-preview-square',
        'artist' => (object) array(
            'name' => 'Sam Rawlings',
            'uri' => 'samrawlings'
        ),
        'extract' => (object)array(
            'title' => 'Bodies Two Blades of Grass',
            'blurb' => '<p>Slender bodies two blades of grass,</p><p>upon the winds so they arose, so they swayed;</p><p>the dawn cloaked, a shroud of snow.</p><p>Yet still their barge smoked prophetically,</p><p>that evening’s warmth beginning to temper</p><p>beneath a cold hue of plunging light.</p>'
        )
    ),
    (object)array(
        'elemClassName' => 'book-preview-rectangle',
        'img' => (object) array(
            'elemClassName' => 'tom-harris',
        ),
        'artist' => (object) array(
            'name' => 'Tom Harris',
            'uri' => 'journal/tom-harris-five-things'
        ),
        'title' => 'Inland'
    ),
    (object)array(
        'elemClassName' => 'book-preview-square',
        'artist' => (object) array(
            'name' => 'Rahima Fitzwilliam Hall',
            'uri' => 'himihall'
        ),
        'extract' => (object)array(
            'title' => 'The Boy Dragged his Wine Crate Boat behind Him',
            'blurb' => 'The boy dragged his wine crate boat behind him as he sailed through the fields he took for the sea – they were flat enough, the horizon steady enough, ripples of freshly turned peat as far as the boy could see. He played captain, fisherman, explorer on the lookout for new land. Crows en masse made for storms in the boundless, otherwise still sky.'
        )
    ),
    (object)array(
        'elemClassName' => 'book-preview-square',
        'img' => (object) array(
            'elemClassName' => 'time-cover',
        ),
        'artist' => (object) array(
            'name' => 'D. S. Chidgey',
            'uri' => ''
        ),
        'title' => 'Time book cover'
    ),
    (object)array(
        'elemClassName' => 'book-preview-square',
        'artist' => (object) array(
            'name' => 'Sam Rawlings',
            'uri' => 'samrawlings'
        ),
        'extract' => (object)array(
            'title' => 'Initially Inspired',
            'blurb' => '<p>Initially inspired by a discussion on gamebooks, this project has taken over three years to grow into what you are now holding in your hands.</p><p>The importance of collaboration has always been central to Lazy Gramophone Press\'s ethos, especially the pairing of words and images. This project therefore, is our chance to bring everyone together under one cover, all focused upon the same theme in order to produce a unique portrait of time.'
        )
    ),
    (object)array(
        'elemClassName' => 'book-preview-rectangle no-edge',
        'img' => (object) array(
            'elemClassName' => 'rima-staines-gospel',
        ),
        'artist' => (object) array(
            'name' => 'Rima Staines',
            'uri' => 'thehermitage'
        ),
        'title' => 'The Scrimstone Circus'
    ),
   (object)array(
        'elemClassName' => 'book-preview-square',
        'artist'=> (object) array(
            'name' => 'Tom Hirons',
            'uri' => 'journal/tom-hirons-five-things'
        ),
        'extract' => (object)array(
            'title' => 'The Day my Trial was to Begin',
            'blurb' => 'The day my trial was to begin, there was a storm. I watched it brew from nowhere, like the arrival of a whale from the deep. Here’s something the ship sank. She went down with stocks and stores and the judge and all twelve of the jurymen sent to try me. The waves ate them like ship’s crackers, without delight or comment but only the necessity of sustenance. I watched them sink. The sea closed over them like history.'
        )
    ),
    (object)array(
        'elemClassName' => 'book-preview-rectangle',
        'img' => (object) array(
            'elemClassName' => 'time-diagram',
        ),
        'artist' => (object) array(
            'name' => 'D. S. Chidgey',
            'uri' => ''
        ),
        'title' => 'Time structure diagram'
    ),
    (object)array(
        'elemClassName' => 'book-preview-square',
        'artist' => (object) array(
            'name' => 'Sam Rawlings',
            'uri' => 'samrawlings'
        ),
        'extract' => (object)array(
            'title' => 'A Visual Guide',
            'blurb' => "The stories in this book have been structured around a Central Story. The Central Story is biographical in that it follows the course of a character's life through childhood to adolescence–adulthood and then on into old age."
        )
    ),
    (object)array(
        'elemClassName' => 'book-preview-square',
        'img' => (object) array(
            'elemClassName' => 'time-book-printing',
        ),
        'artist' => (object) array(
            'name' => 'D. S. Chidgey',
            'uri' => ''
        ),
        'title' => 'Printing'
    ),
    (object)array(
        'elemClassName' => 'book-preview-square',
        'extract' => (object)array(
            'title' => 'Printing',
            'blurb' => 'We work very closely with our printers to ensure our vision on screen translates to the finished pages.'
        )
    ),
    (object)array(
        'elemClassName' => 'book-preview-rectangle',
        'img' => (object) array(
            'elemClassName' => 'kaitlin-beckett',
        ),
        'artist' => (object) array(
            'name' => 'Kaitlin Beckett',
            'uri' => 'journal/kaitlin-becketts-five-things'
        ),
        'title' => 'Ocean'
    ),
    (object)array(
        'elemClassName' => 'book-preview-square',
        'artist' => (object) array(
            'name' => 'Sorana Santo',
            'uri' => 'journal/sorana-santos-five-things'
        ),
        'extract' => (object)array(
            'title' => 'The Storms that Broke the Surface when Our Currents Crossed',
            'blurb' => '<p>The storms that broke the surface when our currents crossed, The nights I drew back deepest – when I learned to swim – </p><p class="top-margin">Forged a stronger wave from out those lowest troughs, That left no stone unturned that was not turned for Him.<p>'
        )
    ),
    (object)array(
        'elemClassName' => 'book-preview-square',
        'img' => (object) array(
            'elemClassName' => 'tim-greaves',
        ),
        'artist' => (object) array(
            'name' => 'Tim Greaves',
            'uri' => ''
        ),
        'title' => 'The Dash In-between'
    ),
    (object)array(
        'elemClassName' => 'book-preview-square',
        'artist' => (object) array(
            'name' => 'Claire Fletcher',
            'uri' => 'journal/claire-fletchers-five-things'
        ),
        'extract' => (object)array(
            'title' => "The Day's Light was Dimming Through the Window",
            'blurb' => '<p>Just as the day\'s light was dimming through the window, I reached over to flatten his crumpled hair. His eyes caught mine, suddenly focussed. I breathed in.</p><p class="tab-left">"Are you scared Granddad..?" I asked him, quietly.</p><span class="tab-left">"No,"</span> he whispered, as fearlessly as I always remember him, eyes at once shiny and determined. "On my gravestone will be my birth date, my death date and a dash in-between. We all would do best to remember that dash in-between..." his voice trailed off, coughing.'
        )
    ),
    (object)array(
        'elemClassName' => 'book-preview-rectangle no-edge',
        'img' => (object) array(
            'elemClassName' => 'rima-staines-circus',
        ),
        'artist' => (object) array(
            'name' => 'Rima Staines',
            'uri' => 'thehermitage'
        ),
        'title' => 'The Scrimstone Circus'
    ),
   (object)array(
        'elemClassName' => 'book-preview-square',
        'artist' => (object) array(
            'name' => 'Tom Hirons',
            'uri' => 'journal/tom-hirons-five-things'
        ),
        'extract' => (object)array(
            'title' => 'My Circus Travelled the Four Kingdoms',
            'blurb' => 'My circus travelled the four kingdoms and the thrice-nine lands, bringing joy to those whose lives were so tarnished as to be polished by such a meagre smear of laughter as the pathetic clowns could offer or the dubious wonder of acrobats who were, to be honest, more flexible with the truth than with their bodies.'
        )
    )
);

$html = '<ul class="book-previews">';
$artistAnchor = '';

$template = array(
    'image' => '<li class="book-preview {elemClassName}"><div class="image-container group">{pictureTitle}{imgClassName}{artistAnchor}</div></li>',
    'text' => '<li class="book-preview extract-preview"><div class="extract group"><div class="font-30pt">{extractTitle}</div><div class="extract-blurb font-16pt">{extractBlurb}</div>{artistAnchor}</div></li>'
);

foreach ($carouselDetails as $artistDetail) {

    $pictureTitle = !empty($artistDetail->title) ? "<h2 class=\"sub-heading font-30pt\">{$artistDetail->title}</h2>" : '';
    $imgClassName = !empty($artistDetail->img->elemClassName) ? "<div class=\"image {$artistDetail->img->elemClassName}\"></div>"  : '';

    $artist = isset($artistDetail->artist) && !empty($artistDetail->artist) ? $artistDetail->artist : null;

    if (null !== $artist) {

        if (empty($artist->uri)){

            $artistHref = 'http://www.lazygramophone.com/';

        } else if ('http' === substr($artist->uri, 0, 4)){

           $artistHref = $artist->uri;

        } else {

           $artistHref = 'http://www.lazygramophone.com/' . $artist->uri;
        }

        $artistAnchor = "<h3 class=\"highlight font-16pt\">by <a class=\"highlight-link\" href=\"{$artistHref}\" target=\"_blank\">{$artist->name}</a></h3>";
    }

    $extractTitle = !empty($artistDetail->extract->title) ? "<h2 class=\"sub-heading\">{$artistDetail->extract->title}</h2>" : '';
    $extractBlurb = !empty($artistDetail->extract->blurb) ? $artistDetail->extract->blurb : '';

    $html .= strtr( $template[ empty($imgClassName) ? 'text' : 'image' ],
        array(
            '{pictureTitle}' => $pictureTitle,
            '{imgClassName}' => $imgClassName,
            '{elemClassName}' => $artistDetail->elemClassName,
            '{extractTitle}' => $extractTitle,
            '{extractBlurb}' => $extractBlurb,
            '{artistAnchor}' => $artistAnchor
        )
    );
}

$html .= '</ul>';

echo $html;